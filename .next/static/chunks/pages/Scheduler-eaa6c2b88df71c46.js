(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[391],{1640:e=>{e.exports={container:"SchedulerForm_container__9wyYQ",title:"SchedulerForm_title__bprj0",title1:"SchedulerForm_title1__Yjd_3",title2:"SchedulerForm_title2__wp46e",form:"SchedulerForm_form__ryPxf",shortInput:"SchedulerForm_shortInput__Ml9hA",shortInputHoliday:"SchedulerForm_shortInputHoliday__w9I1v",inputGroup:"SchedulerForm_inputGroup__8J4D3",button:"SchedulerForm_button__quya1",error:"SchedulerForm_error__2qJFl",results:"SchedulerForm_results__n2FbD",subtitle:"SchedulerForm_subtitle__vLCGH",scheduleTable:"SchedulerForm_scheduleTable__cdHxf",rowGroup:"SchedulerForm_rowGroup__iVJDA",buttonContainer:"SchedulerForm_buttonContainer__0aQfq",backButton:"SchedulerForm_backButton__Th0v1",footer:"SchedulerForm_footer__l0a9C"}},4723:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var l=r(7876),s=r(4232),n=r(7328),a=r.n(n),o=r(9099),i=r(1640),c=r.n(i),d=r(3432),u=r(6515);let h=()=>{let e=(0,o.useRouter)(),[t,r]=(0,s.useState)(""),[n,i]=(0,s.useState)(""),[h,m]=(0,s.useState)(""),[p,_]=(0,s.useState)(null),[x,j]=(0,s.useState)(""),[b,y]=(0,s.useState)(!1),[S,f]=(0,s.useState)(""),[N,g]=(0,s.useState)(2),v=()=>{let e=t.split(",").map(e=>e.trim()).filter(e=>e.length>0),r=S.split(",").map(e=>e.trim()).filter(e=>e.length>0);return{month:Number(n),year:Number(h),employees:e,holidays:r,numAssignees:N}},w=async e=>{e.preventDefault(),j(""),_(null),y(!0);let t=v();if(t.employees.length<N){j("Please enter at least ".concat(N," employees.")),y(!1);return}try{let e=await fetch("/api/generate-schedule",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await e.json();if(!e.ok)throw Error(r.message||"Failed to generate schedule.");_(r.schedule)}catch(e){j(e instanceof Error?e.message:"An unexpected error occurred.")}finally{y(!1)}},F=async()=>{if(j(""),!p)return void j("Please generate a schedule first.");let e=v();try{let t=await fetch("/api/generate-schedule?download=true",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to download the schedule.");let r=await t.blob(),l=window.URL.createObjectURL(r),s=document.createElement("a");s.href=l,s.download="Monthly_COB_Schedule.xlsx",document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(l),s.remove()}catch(e){j(e instanceof Error?e.message:"An unexpected error occurred during download.")}};return(0,l.jsxs)("div",{children:[(0,l.jsxs)(a(),{children:[(0,l.jsx)("title",{children:"COB Runner Scheduler"}),(0,l.jsx)("meta",{name:"description",content:"An automatic scheduler for the Close of Business runner."}),(0,l.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,l.jsxs)("div",{className:c().container,children:[(0,l.jsx)("h1",{className:c().title1,children:"Nib International Bank"}),(0,l.jsx)("h1",{className:c().title2,children:"IS Application Department"}),(0,l.jsx)("h1",{className:c().title,children:"Monthly COB Scheduler"}),(0,l.jsxs)("form",{className:c().form,onSubmit:w,children:[(0,l.jsxs)("div",{className:c().inputGroup,children:[(0,l.jsx)("label",{htmlFor:"employees",children:"Employees (comma-separated):"}),(0,l.jsx)("textarea",{id:"employees",value:t,onChange:e=>r(e.target.value),rows:4,placeholder:"e.g., Fkremariam, Kalkidan, Alemayehu,...",required:!0})]}),(0,l.jsxs)("div",{className:c().inputGroup,children:[(0,l.jsx)("label",{htmlFor:"numAssignees",children:"Number of Employees per day:"}),(0,l.jsx)("input",{id:"numAssignees",type:"number",value:N,onChange:e=>g(parseInt(e.target.value,10)),min:"1",required:!0,className:c().shortInput})]}),(0,l.jsxs)("div",{className:c().inputGroup,children:[(0,l.jsx)("label",{htmlFor:"holidays",children:"Additional Holidays (comma-separated, YYYY-MM-DD):"}),(0,l.jsx)("textarea",{id:"holidays",value:S,onChange:e=>f(e.target.value),rows:2,className:c().shortInputHoliday,placeholder:"e.g., 2025-01-01, 2025-12-25"})]}),(0,l.jsxs)("div",{className:c().rowGroup,children:[(0,l.jsxs)("div",{className:c().inputGroup,children:[(0,l.jsx)("label",{htmlFor:"month",children:"Month:"}),(0,l.jsx)("input",{id:"month",type:"number",value:n,onChange:e=>i(e.target.value),min:"1",max:"12",required:!0,className:c().shortInput})]}),(0,l.jsxs)("div",{className:c().inputGroup,children:[(0,l.jsx)("label",{htmlFor:"year",children:"Year:"}),(0,l.jsx)("input",{id:"year",type:"number",value:h,onChange:e=>m(e.target.value),min:"2024",required:!0,className:c().shortInput})]})]}),(0,l.jsxs)("div",{className:c().buttonContainer,children:[(0,l.jsx)("button",{className:"".concat(c().button," ").concat(c().backButton),type:"button",onClick:()=>{e.push("/")},children:"Back"}),(0,l.jsx)("button",{className:c().button,type:"submit",disabled:b,children:b?"Generating...":"Generate Schedule"})]})]}),x&&(0,l.jsx)("div",{className:c().error,children:x}),p&&(0,l.jsxs)("div",{className:c().results,children:[(0,l.jsx)("h2",{className:c().subtitle,children:"Generated Schedule"}),(0,l.jsxs)("table",{className:c().scheduleTable,children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Date"}),(0,l.jsx)("th",{children:"Day"}),(0,l.jsx)("th",{children:"Assigned Persons"})]})}),(0,l.jsx)("tbody",{children:Object.entries(p).map(e=>{let[t,r]=e,s=(0,d.H)(t),n=(0,u.GP)(s,"EEEE");return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:t}),(0,l.jsx)("td",{children:n}),(0,l.jsx)("td",{children:r.join(", ")})]},t)})})]}),(0,l.jsx)("button",{className:c().button,onClick:F,children:"Download as Excel"})]}),(0,l.jsx)("footer",{className:c().footer,children:(0,l.jsx)("p",{children:"\xa9 2025 IS Application Department, Nib International Bank. All Rights Reserved."})})]})]})}},5192:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/Scheduler",function(){return r(4723)}])}},e=>{e.O(0,[307,636,593,792],()=>e(e.s=5192)),_N_E=e.O()}]);